<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ topic.title }}</title>
</head>
<body>
    <h1>{{ topic.title }}</h1>
    <p>{{ topic.description }}</p>

    {% if session.get("user_id") == author_id or role == "admin" %}
    <form action="/topic/{{ topic.id }}" method="POST" style="margin-top: 20px;">
        <button type="submit" onclick="return confirm('Haluatko varmasti poistaa tämän topicin?');">
            Poista tämä topic
        </button>
    </form>
    {% else %}
    <p>Sinulla ei ole oikeuksia tämän topicin poistamiseen.</p>
    {% endif %}

    <h2>Viestit</h2>
    <ul>
        {% for post in posts %}
            <li>
                <p>{{ post.content }}</p>
                <small>Kirjoittaja: {{ post.author }} | {{ post.created_at }}</small>
                {% if session.get("user_id") == post.user_id or role == "admin" %}
                <form action="/delete_post/{{ post.id }}" method="POST" style="display: inline;">
                    <button type="submit" onclick="return confirm('Haluatko varmasti poistaa tämän viestin?');">
                        Poista viesti
                    </button>
                </form>
                {% endif %}
            </li>
        {% else %}
            <p>Tässä keskustelussa ei ole vielä viestejä.</p>
        {% endfor %}
    </ul>

    <p>
        <a href="/topic/{{ topic.id }}/new_post">Lähetä uusi viesti</a>
    </p>
    
    <p>
        <a href="/region/{{ topic.region_id }}">Takaisin alueeseen</a>
    </p>
</body>
</html>
